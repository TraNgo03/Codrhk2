<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bài tập: Interactive + Responsive Photo Gallery</title>
  <meta name="description" content="Interactive photo gallery — responsive layout with keyboard accessibility and JS events (mouseover, focus, load etc.).">
  <style>
    /* ============== Base (mobile-first) ============== */
    :root {
      --bg: #f7f7fb;
      --card: #ffffff;
      --muted: #6b7280;
      --accent: #2563eb;
    }
    html,body { height: 100%; }
    body {
      margin: 18px;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: var(--bg);
      color: #0f172a;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    h1 { margin: 6px 0 12px; font-size: 1.4rem; }
    p.lead { margin: 0 0 14px; color: var(--muted); }

    /* Gallery layout */
    .gallery {
      display: block;       /* single column on narrow screens */
      gap: 12px;
      margin-bottom: 18px;
    }

    /* Thumbnail images */
    .thumb {
      width: 100%;
      max-width: 480px;    /* keep reasonable on very wide small screens */
      height: auto;
      display: inline-block;
      object-fit: cover;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(12,14,20,0.06);
      border: 2px solid transparent;
      cursor: pointer;
      transition: transform .12s ease, box-shadow .15s ease, border-color .12s ease;
      margin-bottom: 8px;
    }

    /* Hover and focus affordance */
    .thumb:hover,
    .thumb:focus {
      transform: translateY(-6px);
      border-color: var(--accent);
      box-shadow: 0 12px 30px rgba(37,99,235,0.12);
      outline: none;
    }

    .thumb:focus-visible {
      box-shadow: 0 0 0 6px rgba(37,99,235,0.12);
    }

    /* Preview area */
    #image {
      width: 100%;
      max-width: 980px;
      height: 320px;
      background-color: #0b1220;
      background-size: cover;
      background-position: center;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      margin-top: 12px;
      box-shadow: 0 8px 26px rgba(2,6,23,0.06);
      padding: 12px;
      text-align: center;
    }
    #image .caption {
      background: rgba(0,0,0,0.36);
      padding: 10px 14px;
      border-radius: 8px;
      max-width: 92%;
      font-size: 1.05rem;
    }

    .meta {
      margin-top: 12px;
      color: var(--muted);
      font-size: 0.95rem;
    }

    /* Utility container for layout centering */
    .container {
      max-width: 1100px;
      margin: 0 auto;
    }

    /* ============== Media Query 1: tablet / landscape phones ============== */
    @media (min-width: 600px) {
      .gallery {
        display: grid;
        grid-template-columns: repeat(2, minmax(0,1fr));
        gap: 16px;
        align-items: start;
      }
      .thumb {
        width: 100%;
        height: 160px;
        object-fit: cover;
      }
      #image {
        height: 360px;
      }
    }

    /* ============== Media Query 2: desktop / wide screens ============== */
    @media (min-width: 900px) {
      .gallery {
        grid-template-columns: repeat(3, minmax(0,1fr));
        gap: 18px;
      }
      .thumb {
        height: 160px;
      }
      #image {
        height: 420px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Interactive Photo Gallery — Responsive & Accessible</h1>
    <p class="lead">Hover or focus (Tab) on a thumbnail to preview. This example includes JS events (onmouseover, onmouseleave, onfocus, onblur), an onload listener that adds <code>tabindex</code> attributes, and responsive CSS (two media queries).</p>

    <!-- Thumbnails: use inline event attributes as requested (don't delete them) -->
    <div class="gallery" id="thumbRow" aria-label="Photo thumbnails">
      <img class="thumb"
           src="https://picsum.photos/id/1015/800/600"
           alt="Hồ nước giữa núi đá lúc bình minh"
           onmouseover="upDate(this)"
           onmouseleave="undo()"
           onfocus="upDate(this)"
           onblur="undo()"
      />

      <img class="thumb"
           src="https://picsum.photos/id/1025/800/600"
           alt="Chú chó giống Golden Retriever nhìn vào ống kính"
           onmouseover="upDate(this)"
           onmouseleave="undo()"
           onfocus="upDate(this)"
           onblur="undo()"
      />

      <img class="thumb"
           src="https://picsum.photos/id/1039/800/600"
           alt="Biển xanh trong vắt với những con sóng nhẹ"
           onmouseover="upDate(this)"
           onmouseleave="undo()"
           onfocus="upDate(this)"
           onblur="undo()"
      />

      <img class="thumb"
           src="https://picsum.photos/id/1043/800/600"
           alt="Cánh đồng hoa hoang trải dài dưới bầu trời xanh"
           onmouseover="upDate(this)"
           onmouseleave="undo()"
           onfocus="upDate(this)"
           onblur="undo()"
      />

      <img class="thumb"
           src="https://picsum.photos/id/1052/800/600"
           alt="Đường chân trời thành phố về đêm với ánh đèn rực rỡ"
           onmouseover="upDate(this)"
           onmouseleave="undo()"
           onfocus="upDate(this)"
           onblur="undo()"
      />

      <img class="thumb"
           src="https://picsum.photos/id/1069/800/600"
           alt="Con đường mòn xuyên rừng lá vàng mùa thu"
           onmouseover="upDate(this)"
           onmouseleave="undo()"
           onfocus="upDate(this)"
           onblur="undo()"
      />
    </div>

    <!-- Preview panel -->
    <div id="image" role="region" aria-live="polite" aria-atomic="true">
      <div class="caption">Hover over an image below to display here.</div>
    </div>

    <div class="meta">
      <p>Bật DevTools Console (F12) để xem các thông báo (console.log) từ sự kiện <code>load</code>, <code>upDate</code> và <code>undo</code>.</p>
    </div>
  </div>

  <script>
    // Constants
    const IMAGE_DIV_ID = 'image';
    const DEFAULT_TEXT = "Hover over an image below to display here.";

    /**
     * upDate(previewPic)
     * called on mouseover and onfocus via inline attributes
     */
    function upDate(previewPic) {
      console.log('upDate triggered'); // debug: confirm event fires
      if (!previewPic) {
        console.warn('upDate: previewPic is falsy');
        return;
      }

      // Debug info: alt and src
      console.log('previewPic.alt =', previewPic.alt);
      console.log('previewPic.src =', previewPic.src);

      // Update text
      const imageDiv = document.getElementById(IMAGE_DIV_ID);
      if (!imageDiv) return;
      const caption = imageDiv.querySelector('.caption');
      if (caption) caption.textContent = previewPic.alt;
      else imageDiv.textContent = previewPic.alt;

      // Update background-image (CSS inline)
      imageDiv.style.backgroundImage = `url('${previewPic.src}')`;
    }

    /**
     * undo()
     * called on mouseleave and onblur via inline attributes
     */
    function undo() {
      console.log('undo triggered');
      const imageDiv = document.getElementById(IMAGE_DIV_ID);
      if (!imageDiv) return;

      // Reset background-image
      imageDiv.style.backgroundImage = '';

      // Reset text
      const caption = imageDiv.querySelector('.caption');
      if (caption) caption.textContent = DEFAULT_TEXT;
      else imageDiv.textContent = DEFAULT_TEXT;
    }

    /**
     * addTabfocusAttributes()
     * Called once on window load: add tabindex attributes and a custom tabfocus attribute
     */
    function addTabfocusAttributes() {
      console.log('addTabfocusAttributes() running — adding tabindex & tabfocus to thumbnails');
      const thumbs = document.querySelectorAll('.thumb');
      for (let i = 0; i < thumbs.length; i++) {
        const el = thumbs[i];
        // Only set tabindex if not present
        if (!el.hasAttribute('tabindex')) {
          el.setAttribute('tabindex', '0');
        }
        // Add a custom attribute as requested
        el.setAttribute('tabfocus', 'true');
      }
      console.log('Added tabindex & tabfocus to', thumbs.length, 'thumbnails.');
    }

    // Add load listener (onload)
    window.addEventListener('load', function () {
      console.log('window load event fired — initialising gallery');
      addTabfocusAttributes();
    });

    /* Optional: keyboard behavior enhancements
       - Enter/Space while a thumbnail is focused will trigger upDate (preview)
       - Escape will undo
    */
    document.addEventListener('keydown', function (e) {
      const active = document.activeElement;
      if (!active || !active.classList) return;
      if (!active.classList.contains('thumb')) return;

      if (e.key === 'Enter' || e.key === ' ') {
        // prevent default for space so page doesn't scroll
        e.preventDefault();
        upDate(active);
      } else if (e.key === 'Escape') {
        undo();
      }
    });
  </script>
</body>
</html>
